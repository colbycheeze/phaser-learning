!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=1)}([function(e,t){e.exports=Phaser},function(e,t,r){"use strict";r.r(t);var n=r(0),o=r.n(n),i="assets/images",a="assets/sprites",s="assets/tilemaps",c="assets/tilesets",u="assets/atlas",l={LOAD:"LOAD",PLAY:"PLAY",SCORE:"SCORE"},f={SPIKE:"0x72-industrial-spike.png"},p={PLAYER:"0x72-industrial-player-32px-extruded.png"},y={},h={INDUSTRIAL:"0x72-industrial-tileset-32px-extruded.png"},d={PLATFORMER:"platformer.json",PLATFORMER_SIMPLE:"platformer-simple.json"};function b(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(e,t,r){return t&&b(e.prototype,t),r&&b(e,r),e}function m(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var g=function(){function e(t,r,n){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),m(this,"scene",void 0),m(this,"sprite",void 0),m(this,"keys",void 0),this.scene=t,this.sprite=t.physics.add.sprite(r,n,p.PLAYER,0).setDrag(1e3,0).setMaxVelocity(300,400).setSize(18,24).setOffset(7,9);var i=o.a.Input.Keyboard.KeyCodes,a=i.LEFT,s=i.RIGHT,c=i.UP,u=i.W,l=i.A,f=i.D;this.keys=t.input.keyboard.addKeys({left:a,right:s,up:c,w:u,a:l,d:f})}return v(e,null,[{key:"CreateAnimations",value:function(e){var t=e.anims;t.create({key:"player-idle",frames:t.generateFrameNumbers(p.PLAYER,{start:0,end:3}),frameRate:3,repeat:-1}),t.create({key:"player-run",frames:t.generateFrameNumbers(p.PLAYER,{start:8,end:15}),frameRate:12,repeat:-1})}}]),v(e,[{key:"freeze",value:function(){this.sprite.body.moves=!1}},{key:"destroy",value:function(){this.sprite.destroy()}},{key:"update",value:function(){var e=o.a.Input.Keyboard.JustDown,t=this.keys,r=this.sprite,n=r.body.blocked.down,i=n?600:200;t.left.isDown||t.a.isDown?(r.setAccelerationX(-i),r.setFlipX(!0)):t.right.isDown||t.d.isDown?(r.setAccelerationX(i),r.setFlipX(!1)):r.setAccelerationX(0),n&&(e(t.up)||e(t.w))&&r.setVelocityY(-500),n?0!==r.body.velocity.x?r.anims.play("player-run",!0):r.anims.play("player-idle",!0):(r.anims.stop(),r.setTexture(p.PLAYER,10))}}]),e}();function w(e){return(w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function O(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=[],n=!0,o=!1,i=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){o=!0,i=e}finally{try{n||null==s.return||s.return()}finally{if(o)throw i}}return r}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function P(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function k(e,t){return!t||"object"!==w(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function S(e){return(S=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function j(e,t){return(j=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}var T=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),k(this,S(t).call(this,{key:l.LOAD}))}var r,n,b;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&j(e,t)}(t,o.a.Scene),r=t,(n=[{key:"loadImages",value:function(){var e=this;this.load.setPath(i),Object.values(f).forEach(function(t){e.load.image(t,t)})}},{key:"loadTilesets",value:function(){var e=this;this.load.setPath(c),Object.values(h).forEach(function(t){e.load.image(t,t)})}},{key:"loadTilemaps",value:function(){var e=this;this.load.setPath(s),Object.values(d).forEach(function(t){e.load.tilemapTiledJSON(t,t)})}},{key:"loadSpritesheet",value:function(e,t){var r=this;this.load.setPath(a),e.forEach(function(e){r.load.spritesheet(e,e,t)})}},{key:"loadAtlas",value:function(){var e=this;this.load.setPath(u),Object.values(y).forEach(function(t){var r=O(t,2),n=r[0],o=r[1];e.load.atlas(n,n,o)})}},{key:"showLoadingBar",value:function(){var e=this.add.graphics({fillStyle:{color:16777215}}),t=this.game.renderer.width/2,r=this.game.renderer.height/2,n=.8*this.game.renderer.width;this.load.on("progress",function(o){var i=n*o;e.fillRect(t-i/2,r-25,i,50)})}},{key:"preload",value:function(){this.loadImages(),this.loadTilesets(),this.loadTilemaps(),this.loadSpritesheet([p.PLAYER],{frameWidth:32,frameHeight:32,margin:1,spacing:2}),this.showLoadingBar()}},{key:"create",value:function(){g.CreateAnimations(this),this.scene.start(l.PLAY)}}])&&P(r.prototype,n),b&&P(r,b),t}();function x(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function A(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var L=function(){function e(t,r){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),A(this,"map",void 0),A(this,"scene",void 0),A(this,"graphics",void 0),this.map=r,this.scene=t,this.graphics=t.add.graphics();var n=this.graphics;n.lineStyle(5,16777215,1),n.strokeRect(0,0,r.tileWidth,r.tileHeight),n.lineStyle(3,16732024,1),n.strokeRect(0,0,r.tileWidth,r.tileHeight)}var t,r,n;return t=e,(r=[{key:"handleInput",value:function(){var e=this.scene,t=e.cameras,r=e.groundLayer,n=e.input.activePointer,o=n.positionToCamera(t.main);n.isDown&&r.putTileAtWorldXY(6,o.x,o.y).setCollision(!0)}},{key:"update",value:function(){var e=this.scene.input.activePointer.positionToCamera(this.scene.cameras.main),t=this.map.worldToTileXY(e.x,e.y),r=this.map.tileToWorldXY(t.x,t.y);this.graphics.setPosition(r.x,r.y),this.handleInput()}},{key:"destroy",value:function(){this.graphics.destroy()}}])&&x(t.prototype,r),n&&x(t,n),e}();function E(e){return(E="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function D(e){return(D=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function R(e,t){return(R=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function C(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function I(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Y=function(e){function t(){var e,r,n;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,e=!(n=D(t).call(this,{key:l.PLAY}))||"object"!==E(n)&&"function"!=typeof n?C(r):n,I(C(C(e)),"marker",void 0),I(C(C(e)),"player",void 0),I(C(C(e)),"map",void 0),I(C(C(e)),"isPlayerDead",!1),I(C(C(e)),"spikeGroup",void 0),I(C(C(e)),"groundLayer",void 0),e}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&R(e,t)}(t,o.a.Scene),r=t,(n=[{key:"createWorld",value:function(){var e=this;this.map=this.make.tilemap({key:d.PLATFORMER});var t=this.map,r=t.addTilesetImage(h.INDUSTRIAL,h.INDUSTRIAL);t.createDynamicLayer("Background",r),this.groundLayer=t.createDynamicLayer("Ground",r);var n=this.groundLayer;t.createDynamicLayer("Foreground",r),n.setCollisionByProperty({collides:!0}),this.spikeGroup=this.physics.add.staticGroup(),n.forEachTile(function(t){if(77===t.index){var r=e.spikeGroup.create(t.getCenterX(),t.getCenterY(),f.SPIKE);r.rotation=t.rotation,0===r.angle?r.body.setSize(32,6).setOffset(0,26):-90===r.angle?r.body.setSize(6,32).setOffset(26,0):90===r.angle&&r.body.setSize(6,32).setOffset(0,0),n.removeTileAt(t.x,t.y)}})}},{key:"createHelpText",value:function(){this.add.text(16,16,"Arrow/WASD to move & jump\nLeft click to draw platforms",{font:"18px monospace",fill:"#000000",padding:{x:20,y:10},backgroundColor:"#ffffff"}).setScrollFactor(0)}},{key:"createPlayer",value:function(){var e=this.map,t=this.physics,r=this.groundLayer,n=e.findObject("Objects",function(e){return"Spawn Point"===e.name}),o=n.x,i=n.y;this.player=new g(this,o,i),t.add.collider(this.player.sprite,r)}},{key:"createInput",value:function(){var e=this,t=this.groundLayer;this.input.keyboard.once("keydown_F1",function(){e.physics.world.createDebugGraphic();var r=e.add.graphics().setAlpha(.75).setDepth(20);t.renderDebug(r,{tileColor:null,collidingTileColor:new o.a.Display.Color(243,134,48,255),faceColor:new o.a.Display.Color(40,39,37,255)})})}},{key:"handleSpikeCollision",value:function(){var e=this.scene,t=this.player,r=this.physics,n=this.groundLayer,o=this.spikeGroup,i=this.cameras;if(t.sprite.y>n.height||r.world.overlap(t.sprite,o)){this.isPlayerDead=!0;var a=i.main;a.shake(100,.05),a.fade(550,0,0,0),t.freeze(),a.once("camerafadeoutcomplete",function(){t.destroy(),e.restart()})}}},{key:"create",value:function(){this.isPlayerDead=!1,this.createWorld(),this.createHelpText(),this.createPlayer();var e=this.player,t=this.map,r=this.cameras.main;r.startFollow(e.sprite),r.setBounds(0,0,t.widthInPixels,t.heightInPixels),this.marker=new L(this,t),this.createInput()}},{key:"update",value:function(){var e=this.player,t=this.isPlayerDead,r=this.marker;t||(e.update(),r.update(),this.handleSpikeCollision())}}])&&_(r.prototype,n),i&&_(r,i),t}();function F(e){return(F="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function G(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function M(e){return(M=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function W(e,t){return(W=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function X(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}var z=function(e){function t(){var e,r,n,o,i,a;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),r=this,e=!(n=M(t).call(this,{key:l.SCORE}))||"object"!==F(n)&&"function"!=typeof n?X(r):n,o=X(X(e)),a=0,(i="score")in o?Object.defineProperty(o,i,{value:a,enumerable:!0,configurable:!0,writable:!0}):o[i]=a,e}var r,n,i;return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&W(e,t)}(t,o.a.Scene),r=t,(n=[{key:"createScore",value:function(){this.score=0,this.scoreText=this.add.text(16,16,"score: 0",{fontSize:"32px",fill:"#000"})}},{key:"updateScore",value:function(){this.score+=10,this.scoreText.setText("Score: ".concat(this.score))}},{key:"resetScore",value:function(){this.score=0,this.scoreText.setText("Score: ".concat(this.score))}},{key:"create",value:function(){var e=this.scene.get(l.PLAY);this.createScore(),e.events.on("collectStar",this.updateScore,this),e.events.on("restartGame",this.resetScore,this)}}])&&G(r.prototype,n),i&&G(r,i),t}();new o.a.Game({type:o.a.AUTO,width:800,height:600,parent:"game-container",physics:{default:"arcade",arcade:{gravity:{y:1e3},debug:!1,pixelArt:!0}},scene:[T,Y,z]})}]);
//# sourceMappingURL=main.js.map